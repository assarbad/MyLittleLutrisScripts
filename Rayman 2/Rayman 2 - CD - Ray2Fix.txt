files:
- game_patch: https://github.com/legluondunet/MyLittleLutrisScripts/raw/refs/heads/master/Rayman%202/rayman2_patch.zip
- wrapper: https://github.com/legluondunet/mlls-tools/raw/refs/heads/master/dgVoodoo2/dgVoodoo2_79_3.zip
- mod: https://github.com/spitfirex86/Ray2Fix/releases/download/v1.4.1-01/Ray2Fix_1.4.1-01.zip
game:
  exe: drive_c/UbiSoft/Rayman2/Rayman2.exe
  launch_configs:
  - exe: $GAMEDIR/drive_c/UbiSoft/Rayman2/R2FixCfg.exe
    name: Ray2Fix
  prefix: $GAMEDIR
installer:
- task:
    arch: win64
    name: create_prefix
    prefix: $GAMEDIR
- insert-disc:
    requires: Rayman2.exe
- execute:
    command: mkdir -p "$GAMEDIR/drive_c/UbiSoft/Rayman2"; cd "$GAMEDIR/drive_c/UbiSoft/Rayman2";
      cp -vR "$DISC/"* "."; chmod u+w -R "."; cp "Dll/SND_CPA_MMX.ini" "Dll/SND_CPA.ini";
    return_code: 256
- merge:
    dst: $GAMEDIR/drive_c/UbiSoft/Rayman2/backup
    src: $GAMEDIR/drive_c/UbiSoft/Rayman2/Rayman2.exe
- extract:
    dst: $GAMEDIR/drive_c/UbiSoft/Rayman2
    file: game_patch
- extract:
    dst: $GAMEDIR/drive_c/UbiSoft/Rayman2
    file: mod
- extract:
    dst: $CACHE
    file: wrapper
- merge:
    dst: $GAMEDIR/drive_c/UbiSoft/Rayman2
    src: $CACHE/3Dfx/x86/Glide2x.dll
- merge:
    dst: $GAMEDIR/drive_c/UbiSoft/Rayman2
    src: $CACHE/dgVoodooCpl.exe
- merge:
    dst: $GAMEDIR/drive_c/UbiSoft/Rayman2/Dll
    src: $GAMEDIR/drive_c/UbiSoft/Rayman2/DLL
- write_config:
    data:
      Rayman2:
        GLI_Mode: 1 - $RESOLUTION_WIDTH x $RESOLUTION_HEIGHT x 16
    file: $GAMEDIR/drive_c/UbiSoft/Rayman2/ubi.ini
    merge: true
- write_config:
    data:
      General:
        EnumerateRefreshRates: true
        FullScreenMode: true
        KeepWindowAspectRatio: true
        ProgressiveScanlineOrder: true
        ScalingMode: stretched_ar
      GeneralExt:
        FPSLimit: 60
        FullscreenAttributes: fake
      Glide:
        3DfxWatermark: false
        EnableGlideGammaRamp: true
        EnableInactiveAppState: false
        ForceVerticalSync: false
        MemorySizeOfTMU: 4096
        NumberOfTMUs: 2
        OnboardRAM: 12
        Resolution: desktop
        VideoCard: voodoo_2
      GlideExt:
        Dithering: forcealways
        DitheringEffect: pure32bit
    file: $GAMEDIR/drive_c/UbiSoft/Rayman2/dgVoodoo.conf
    merge: false
- move:
    dst: $CACHE
    src: $GAMEDIR/drive_c/UbiSoft/Rayman2/DLL
- execute:
    command: cd "$GAMEDIR/drive_c/UbiSoft/Rayman2"; rm -f -r Acrobat DIRECTX Drivers
      InstData Pads "Tonic Trouble" Autorun.inf D3DImm.dll DDraw.dll DSETUP* GXSetup.exe
      setup.exe SetupUbi.exe ; cd "Data/World/Levels/"; rm -f -f -r GRAPHICS2.DAT
      MAP1.DAT ANIMS1.DAT MUSIC2.DAT MUSIC1.DAT SOUNDS0.DAT GRAPHICS0.DAT SOUNDS1.DAT
      LEVELS1.DAT ANIMS0.DAT MAP2.DAT SOUNDS2.DAT TEXTURES2.DAT ANIMS2.DAT MENU2.DAT
      MENU0.DAT MUSIC0.DAT TEXTURES0.DAT TEXTURES1.DAT LEVELS2.DAT MAP0.DAT MENU1.DAT
      GRAPHICS1.DAT;
wine:
  overrides:
    dinput: n,b
    dinput8: n,b
