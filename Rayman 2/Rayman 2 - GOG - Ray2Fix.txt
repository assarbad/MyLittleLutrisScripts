files:
- wrapper: https://github.com/legluondunet/mlls-tools/raw/refs/heads/master/dgVoodoo2/dgVoodoo2_79_3.zip
- mod: https://github.com/spitfirex86/Ray2Fix/releases/download/v1.4.1/Ray2Fix_1.4.1.zip
- gogsetup: N/A:Select the GOG setup exe
game:
  exe: drive_c/GOG Games/Rayman 2/Rayman2.exe
  launch_configs:
  - exe: $GAMEDIR/drive_c/GOG Games/Rayman 2/R2FixCfg.exe
    name: Ray2Fix
  prefix: $GAMEDIR
installer:
- task:
    arch: win64
    name: create_prefix
    prefix: $GAMEDIR
- extract:
    dst: $GAMEDIR/drive_c/GOG Games/Rayman 2
    file: gogsetup
    format: gog
- extract:
    dst: $GAMEDIR/drive_c/GOG Games/Rayman 2
    file: mod
- extract:
    dst: $CACHE
    file: wrapper
- merge:
    dst: $GAMEDIR/drive_c/GOG Games/Rayman 2/backup
    src: $GAMEDIR/drive_c/GOG Games/Rayman 2/Glide2x.dll
- merge:
    dst: $GAMEDIR/drive_c/GOG Games/Rayman 2
    src: $CACHE/3Dfx/x86/Glide2x.dll
- merge:
    dst: $GAMEDIR/drive_c/GOG Games/Rayman 2/backup
    src: $GAMEDIR/drive_c/GOG Games/Rayman 2/dgVoodoo.conf
- merge:
    dst: $GAMEDIR/drive_c/GOG Games/Rayman 2/backup
    src: $GAMEDIR/drive_c/GOG Games/Rayman 2/ubi.ini
- write_config:
    data:
      Rayman2:
        GLI_Mode: 1 - $RESOLUTION_WIDTH x $RESOLUTION_HEIGHT x 16
    file: $GAMEDIR/drive_c/GOG Games/Rayman 2/ubi.ini
    merge: true
- write_config:
    data:
      General:
        EnumerateRefreshRates: true
        FullScreenMode: true
        KeepWindowAspectRatio: true
        ProgressiveScanlineOrder: true
        ScalingMode: stretched_ar
      GeneralExt:
        FPSLimit: 60
        FullscreenAttributes: fake
      Glide:
        3DfxWatermark: false
        EnableGlideGammaRamp: true
        EnableInactiveAppState: false
        ForceVerticalSync: false
        MemorySizeOfTMU: 4096
        NumberOfTMUs: 2
        OnboardRAM: 12
        Resolution: desktop
        VideoCard: voodoo_2
      GlideExt:
        Dithering: forcealways
        DitheringEffect: pure32bit
    file: $GAMEDIR/drive_c/GOG Games/Rayman 2/dgVoodoo.conf
    merge: false
- execute:
    command: cd "$GAMEDIR/drive_c/GOG Games/Rayman 2"; rm -f -r __support 3Dfx* D3DImm.dll
      DDraw.dll glide* goggame* GXSetup.exe nglide_* nGlideEULA.txt webcache.zip;
wine:
  overrides:
    dinput: n,b
    dinput8: n,b
